<!DOCTYPE html>
<html lang="mr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>गुणयादी - Marklist</title>
  <style>
/* Prevent mobile browsers from auto-inflating text sizes */
html, body {
  -webkit-text-size-adjust: 100% !important;
  -ms-text-size-adjust: 100% !important;
  text-size-adjust: 100% !important;
}

body {
  font-family: "Noto Sans Devanagari", "Mangal", sans-serif;
  font-size: 13px;
}

/* Table styling */
table {
  border-collapse: collapse;
  width: 100%;
  table-layout: fixed;
  margin-bottom: 20px;
  text-align: center; /* default for other columns */
}

th, td {
  border: 1px solid #000;
  padding: 4px;
  vertical-align: middle;
}

input {
  width: 100%;
  border: none;
  text-align: center; /* default center */
  font-size: 13px;
}

input:focus {
  outline: none;
  background: #ffffcc;
}

/* Header / subheader */
.header, .school-heading h4 {
  text-align: center;
  font-weight: bold;
  font-size: 15px;
  padding: 6px 0;
}

.sub-header, .school-heading h5 {
  text-align: center;
  font-size: 14px;
  margin-top: -4px;
}

/* Dropdowns */
.dropdowns {
  text-align: center;
  margin: 10px 0;
}

select, button {
  margin: 0 5px;
  padding: 3px 6px;
  font-size: 13px;
}

/* Table meta */
.table-meta {
  text-align: center;
  font-size: 13px;
  margin: 6px 0 4px 0;
  font-weight: 600;
}

/* Vertical headers (handled via SVG) */
.vertical {
  padding: 6px 2px;
}

th.vertical svg {
  display: block;
  margin: 0 auto;
  overflow: visible;
}

/* Column widths */
.col-num { width: 30px; }
.col-name { width: 180px; } /* student name column */
.small-col { width: 28px; }

/* PDF button */
.pdf-btn {
  
  padding: 8px 16px;
  font-size: 14px;
  font-weight: bold;
  color:#fff;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

/* Page break for printing */
.page-break { page-break-after: always; break-after: page; }

@page {
  size: A4 portrait;
  margin: 15mm;
}

/* Print adjustments */
@media print {
  body { margin: 0; padding: 0; }
  thead { display: table-header-group!important; }
  tfoot { display: table-footer-group!important; }
  table { page-break-inside: auto; max-width: 100%; width: 100% !important; }
  tr { page-break-inside: avoid !important; break-inside: avoid !important; }
  th, td { padding: 3px !important; font-size: 11px !important; }
  input { font-size: 11px !important; padding: 2px !important; }
  .school-heading h4, .header { font-size: 14px !important; }
  .school-heading h5, .sub-header { font-size: 12px !important; }
  .meta-row { font-size: 12px !important; }
}

/* School heading & meta-row */
.school-heading {
  text-align: center;
  margin-bottom: 8px;
}

.school-heading h4, .school-heading h5 {
  margin: 0;
}

.meta-row {
  text-align: center;
  font-weight: bold;
  margin: 4px 0;
  font-size: 14px;
}

/* Mobile screen adjustments */
@media only screen and (max-width: 600px) {
  body { font-size: 11px !important; }
  .header, .school-heading h4 { font-size: 14px !important; }
  .sub-header, .school-heading h5, .meta-row { font-size: 12px !important; }
  .dropdowns select, .dropdowns button { font-size: 12px !important; padding: 2px 4px !important; }
}

/* -------------------- Force header and student name alignment -------------------- */

/* Header "विद्यार्थ्याचे नाव" centered */
#tablesContainer thead th.col-name {
  text-align: center !important;
}

/* Student names in 2nd column left-aligned */
#tablesContainer tbody td:nth-child(2) {
  text-align: left !important;
}

/* Left-align any input inside 2nd column */
#tablesContainer tbody td:nth-child(2) input {
  text-align: left !important;
}

/* Keep all other inputs center-aligned */
#tablesContainer tbody td:not(:nth-child(2)) input {
  text-align: center;
}
/* Right-align the "ठेवलेले गुण →" cell in the first row of tbody */
#tablesContainer tbody tr:first-child td:nth-child(2) {
  text-align: right !important;
  font-weight: bold;
}
/* Thicker outer border for table */
#tablesContainer table {
  border: 2px solid #000 !important;   /* outer frame thicker */
  border-collapse: collapse;
}

/* Keep inside grid lines thinner */
#tablesContainer th, 
#tablesContainer td {
  border: 1px solid #000;
}
/* -------------------- School logo with heading -------------------- */
.school-heading {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 15px; /* space between logo and text */
  margin-bottom: 8px;
}

.school-heading img {
  height: 60px;   /* adjust logo size */
  width: auto;
}
.school-header {
  display: flex;
  align-items: center;
  justify-content: center; /* centers the whole block */
  gap: 15px;
  margin-bottom: 10px;
}

.school-logo {
  width: 60px; /* adjust size as needed */
  height: auto;
}

.school-name {
  text-align: center;
}
.action-buttons {
  display: flex;        /* makes buttons appear in a row */
  justify-content: center; /* center horizontally */
  gap: 5px;             /* space between buttons; reduce from 10px to 5px */
  margin-top: 10px;     /* optional spacing from table */
}

.pdf-btn {
  padding: 8px 16px;    /* button size */
  
}
.pdf-btn.download { background-color: #007bff; }
.pdf-btn.save { background-color: #28a745; }
.pdf-btn.clear { background-color: #dc3545; }

</style>
</head>
<body>

  <div class="sub header">पुणे विद्यार्थी गृहाचे</div>
  <div class="header">विद्याप्रशाला हायस्कूल व ज्युनि.कॉलेज,तळेगांव (अं.) ता.जि.नाशिक </div>

  <!-- Session & Year Dropdowns -->
  <div class="dropdowns">
    <label>सत्र:
      <select id="sessionSelect">
        <option value="">--निवडा--</option>
        <option value="प्रथम सत्र परीक्षा">प्रथम सत्र परीक्षा</option>
        <option value="द्वितीय सत्र परीक्षा">द्वितीय सत्र परीक्षा</option>
      </select>
    </label>
    <label>सन:
      <select id="yearSelect">
        <option value="">--निवडा--</option>
        <option value="२०२५-२६">२०२५-२६</option>
        <option value="२०२६-२७">२०२६-२७</option>
        <option value="२०२७-२८">२०२७-२८</option>
        <option value="२०२८-२९">२०२८-२९</option>
        <option value="२०२९-३०">२०२९-३०</option>
      </select>
    </label>
  </div>

  <!-- Class/Section/Subject/Teacher Dropdowns -->
  <div class="dropdowns">
    <label>इयत्ता:
      <select id="classSelect">
        <option value="">--निवडा--</option>
        <option value="5">५ वी</option>
        <option value="6">६ वी</option>
        <option value="7">७ वी</option>
        <option value="8">८ वी</option>
      </select>
    </label>
    <label>तुकडी:
      <select id="sectionSelect">
        <option value="">--निवडा--</option>
        <option value="A">अ</option>
        <option value="B">ब</option>
        <option value="C">क</option>
      </select>
    </label>
    <label>विषय:
      <select id="subjectSelect">
        <option value="">--निवडा--</option>
        <option>मराठी</option><option>हिंदी</option><option>इंग्रजी</option>
        <option>गणित</option><option>विज्ञान</option><option>परिसर१/२</option>
        <option>इतिहास</option><option>भूगोल</option><option>कला</option>
        <option>कार्यानुभव</option><option>शा. शिक्षण</option>
      </select>
    </label>
    <label>विषय शिक्षक:
      <select id="teacherSelect">
        <option value="">--निवडा--</option>
        <option>श्रीम. कुवर एस.पी.</option><option>श्रीम. गोकुळे एस.</option>
        <option>श्री. वाघमारे एस.एन.</option><option>श्रीम. तुंगार एस. बी.</option>
        <option>श्री. निंबेकर.एस.एल.</option><option>श्रीम. शिवदे आर.डी.</option>
        <option>श्रीम. ठाकूर पी.बी.</option><option>सौ. अमृतकर एस.एम.</option>
        <option>श्री. वाळूंज.एम.बी.</option><option>श्रीम. राजपूत पी.आर.</option>
        <option>श्री. कापडणीस पी.एन.</option><option>श्री. चव्हाण एल.एम.</option>
        <option>सौ. धामणे एस.वाय.</option><option>सौ. भावसार एस.एम.</option>
        <option>श्री. गवळी पी.पी.</option><option>श्री. गावित व्ही.</option>
        <option>श्री. कोठावदे एस.पी.</option>
      </select>
    </label>
    <button onclick="loadStudents()">Go</button>
  </div>
    
   <div id="tablesContainer"></div>
  <div id="pdfButtonContainer" style="text-align:center;"></div>

  <!-- html2pdf.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <script>
    // Student Data (unchanged)
    const studentData = {
      "5-A": ["शर्वरी संतोष सुरवाडे","आराध्या सुनील फुपाटे","चैताली जयराम डगळे",
        "गौरी शरद मुंजे","ईश्वरी संजय डगळे","मानसी कमलाकर निंबेकर",
        "पायल शिवाजी रौंदळे","मीताक्षी मुकुंदा डगळे","समृद्धी पांडुरंग झोले",
        "श्रेया श्रावण बोंबले","अंकिता आकाश गायकवाड","अनन्या संपत जुंद्रे",
        "आराध्या योगेश दाते","आरोही ज्ञानेश्वर पगार","आर्या समाधान दाते",
        "भक्ती दिनकर दाते","दिव्या नवनाथ दाते","दुर्वा शिवराम पोरजे",
        "गौरी नामदेव पगार","गायत्री एकनाथ दाते","ईश्वरी भाऊसाहेब मोरे",
        "जान्हवी गणेश पगार","मानसी समाधान बोडके","स्वरा धनाजी पगार",
        "श्रावणी पोपट पगार","आर्यन शशिकांत शिंदे","दर्शन हिरामण कचरे",
        "हर्षद विष्णू निंबेकर","रंजन शरद कचरे","ऋषिकेश अशोक भोईर",
        "सौरभ सुनील दसुडे","आदित्य गणेश चव्हाण","विनोद सुनील मोहिते",
        "अभिमन्यू संतोष मोरे","कृष्णा विलास मोरे","प्रथमेश केशव दाते",
        "ऋषभ रवींद्र मोरे","ऋषिकेश गोटीराम दाते","साई सचिन दाते",
        "साई संदीप महाले","श्लोक सुरेश दाते","यश उमेश पगार"
      ],
      "5-B": ["भाग्यश्री गणपत बुरंगे","चित्रा अनिल लहांगे","चैताली अनिल लहांगे",
        "दिव्या गोकुळ निंबेकर","गौरी कैलास गोरे","ईश्वरी राजेंद्र डगळे",
        "कावेरी पप्पू खोडे","माधुरी संजय शिवरे","माधुरी सिताराम झुरडे",
        "मनीषा सोमनाथ कोरडे","मयुरी बळवंत निंबेकर","प्रतीक्षा भाऊराव भोईर",
        "पुनम भिका भोईर","रुचिता कैलास निंबेकर","शुभ्रा कैलास पाटील",
        "सुहानी संदीप निंबेकर","स्वीटी योगेश ससाणे","वैष्णवी मोहन भोईर",
        "वैष्णवी रमेश इंगळे","योगेश्वरी संतोष निंबेकर","आर्णव सुरेश निंबेकर",
        "अमोल मोहन निंबेकर","आशिष गणेश दाते","दक्ष नागेश भोईर",
        "हर्षद पांडुरंग डगळे","कार्तिकी जयराम निंबेकर","केशव संतोष महाले",
        "मनोज संदीप लहांगे","निखिल पप्पू निंबेकर","ओमकार राजेंद्र निंबेकर",
        "पार्थ संतोष दाते","प्रेम लक्ष्मण झुरडे","रुद्र रामनाथ निंबेकर",
        "रुद्र सचिन मोरे","ऋषिकेश पांडुरंग झोले","साहिल छगन निंबेकर",
        "सोहम सुरेश"
      ]
    };

    // Table Template (keeps your format)
    function createTable(startIndex, students, metaText) {
      let html = `
      <div class="school-heading">
       <img src="https://raw.githubusercontent.com/prakashgawali2184-lgtm/Marklist/main/pvg1.png
              ">
 
       <div> 
        <h4>पुणे विद्यार्थी गृहाचे</h4>
        <h5>विद्याप्रशाला हायस्कूल व ज्युनि. कॉलेज, तळेगांव (अं.) ता.जि.नाशिक</h5>
      </div>
      </div>
       
      <div class="table-meta">
        ${metaText}</div>
       <table id="tablesContainer" class="page-break">
        <thead>
          <tr>
            <th class="col-num" rowspan="2">ह.क्र.</th>
            <th class="col-name" rowspan="2">विद्यार्थ्याचे नाव</th>
            <th colspan="8">आकारिक मुल्यमापन - अ</th>
            <th class="vertical" rowspan="2">एकूण (अ)</th>
            <th colspan="3">संकलित मुल्यमापन - ब</th>
            <th class="vertical" rowspan="2">एकूण (ब)</th>
            <th class="vertical" rowspan="2">एकूण</th>
            <th rowspan="2">श्रेणी</th>
          </tr>
          <tr>
            <th class="vertical small-col">दै. निरीक्षण</th>
            <th class="vertical small-col">तोंडी काम</th>
            <th class="vertical small-col">प्रात्य./प्रयोग</th>
            <th class="vertical small-col">उपक्रम / कृती</th>
            <th class="vertical small-col">प्रकल्प</th>
            <th class="vertical small-col">चाचणी</th>
            <th class="vertical small-col">स्वाध्याय / वर्गकार्य</th>
            <th class="vertical small-col">इतर</th>
            <th class="vertical small-col">तोंडी</th>
            <th class="vertical small-col">प्रात्यक्षिक</th>
            <th class="vertical small-col">लेखी</th>
          </tr>
        </thead>
        <tbody>
          <!-- ठेवलेले गुण row -->
          <tr>
            <td></td>
<td><b>ठेवलेले गुण →</b></td>
${'<td><input type="number"     enterkeyhint="enter" oninput="updateTotals(this)" /></td>'.repeat(8)}
<td class="aTotal"></td>
${'<td><input type="number"   enterkeyhint="enter" oninput="updateTotals(this)" /></td>'.repeat(3)}
<td class="bTotal"></td>
<td class="grandTotal"></td>
<td class="grade" style="visibility:hidden;"></td>
</tr>
`;
      students.forEach((name, i) => {
  html += `
  <tr>
    <td>${startIndex + i}</td>
<td>${name}</td>
${'<td><input type="text" inputmode="numeric" enterkeyhint="enter" oninput="updateTotals(this)" /></td>'.repeat(8)}
<td class="aTotal"></td>
${'<td><input type="text" inputmode="numeric" enterkeyhint="enter" oninput="updateTotals(this)" /></td>'.repeat(3)}
<td class="bTotal"></td>
<td class="grandTotal"></td>
<td class="grade"></td>
</tr>`;
});
      html += "</tbody></table>";
      return html;
    }

    // Replace vertical header cells with inline SVG text (bottom -> top)
    function replaceVerticalHeaders() {
      const ths = document.querySelectorAll('#tablesContainer th.vertical');
      ths.forEach(th => {
        // skip if already converted
        if (th.dataset.svg === "done") return;

        const txt = th.textContent.trim();
        if (!txt) return;

        // clear the cell
        th.textContent = '';

        // create an inline SVG that rotates the text so it's readable bottom->top
        const svgNS = "http://www.w3.org/2000/svg";
        const w = 32;   // width of svg area
        const h = 120;  // height of svg area (tweak if text long)
        const svg = document.createElementNS(svgNS, 'svg');
        svg.setAttribute('width', w);
        svg.setAttribute('height', h);
        svg.setAttribute('viewBox', `0 0 ${w} ${h}`);
        svg.setAttribute('aria-hidden', 'true');

        // center pivot
        const cx = w / 2;
        const cy = h / 2;

        const textEl = document.createElementNS(svgNS, 'text');
        textEl.setAttribute('x', cx);
        textEl.setAttribute('y', cy);
        textEl.setAttribute('text-anchor', 'middle');
        textEl.setAttribute('dominant-baseline', 'middle');
        textEl.setAttribute('transform', `rotate(-90 ${cx} ${cy})`);
        textEl.setAttribute('style', 'font-family: "Noto Sans Devanagari", "Mangal", sans-serif; font-size:12px;');
        textEl.textContent = txt;

        svg.appendChild(textEl);
        th.appendChild(svg);

        // mark done so we don't double-convert
        th.dataset.svg = "done";
      });
    }

    function loadStudents() {
  const sessionText = document.getElementById("sessionSelect").value;
  const yearText = document.getElementById("yearSelect").value;
  const classSelect = document.getElementById("classSelect");
  const clsText = classSelect.options[classSelect.selectedIndex] ? classSelect.options[classSelect.selectedIndex].text : '';
  const cls = classSelect.value;
  const secSelect = document.getElementById("sectionSelect");
  const secText = secSelect.options[secSelect.selectedIndex] ? secSelect.options[secSelect.selectedIndex].text : '';
  const sec = secSelect.value;
  const subjectText = document.getElementById("subjectSelect").value;
  const teacherText = document.getElementById("teacherSelect").value;

  if (!cls || !sec) { alert("इयत्ता आणि तुकडी निवडा"); return; }

  const key = cls + "-" + sec;
  const students = studentData[key];
  if (!students) { alert("या वर्गासाठी यादी उपलब्ध नाही"); return; }

  const container = document.getElementById("tablesContainer");
  container.innerHTML = "";  // Clear old table

  // --- Table meta info ---
  const metaText = `
    <div class="meta-row">${sessionText} • सन - ${yearText}</div>
    <div class="meta-row">• इयत्ता - ${clsText} • तुकडी - ${secText} • विषय - ${subjectText} • विषय शिक्षक - ${teacherText}</div>
  `;

  // --- Create tables ---
  const perPage = 25;
  for (let i = 0; i < students.length; i += perPage) {
    const chunk = students.slice(i, i + perPage);
    container.innerHTML += createTable(i + 1, chunk, metaText);
  }

  // --- Fix vertical headers ---
  replaceVerticalHeaders();

  // --- Load saved data into inputs ---
  loadData();

  // --- Add PDF, Save, Clear buttons at the end ---
  document.getElementById("pdfButtonContainer").innerHTML = `
    <div class="action-buttons">
      <button class="pdf-btn download" onclick="downloadPDF()">Download PDF</button>
      <button class="pdf-btn save" onclick="saveData()">Save</button>
      <button class="pdf-btn clear" onclick="clearData()">Clear</button>
    </div>
  `;
}

    
      function updateTotals(input) {
  const row = input.closest("tr");
  if (!row) return;

  const allInputs = Array.from(row.querySelectorAll("input"));

  // --- Group A (first 8 inputs) ---
  let aSum = 0;
  let aFilled = false;
  for (let i = 0; i < 8; i++) {
    const inp = allInputs[i];
    if (!inp) continue;
    const txt = String(inp.value ?? "").trim();
    if (txt !== "") {
      aFilled = true;
      const v = parseFloat(txt);
      if (!isNaN(v)) aSum += v;
    }
  }

  // --- Group B (next 3 inputs: 8, 9, 10) ---
  let bSum = 0;
  let bFilled = false;
  for (let i = 8; i < 11; i++) {
    const inp = allInputs[i];
    if (!inp) continue;
    const txt = String(inp.value ?? "").trim();
    if (txt !== "") {
      bFilled = true;
      const v = parseFloat(txt);
      if (!isNaN(v)) bSum += v;
    }
  }

  // Update totals separately
  const aCell = row.querySelector(".aTotal");
  const bCell = row.querySelector(".bTotal");
  if (aCell) aCell.textContent = aFilled ? aSum : "";
  if (bCell) bCell.textContent = bFilled ? bSum : "";

  // Grand total & grade
  const grandCell = row.querySelector(".grandTotal");
  const gradeCell = row.querySelector(".grade");

  if (aFilled || bFilled) {
    const total = (aFilled ? aSum : 0) + (bFilled ? bSum : 0);
    if (grandCell) grandCell.textContent = total;

    let gradeText = "";
    if (total >= 91) gradeText = "अ१";
    else if (total >= 81) gradeText = "अ२";
    else if (total >= 71) gradeText = "ब१";
    else if (total >= 61) gradeText = "ब२";
    else if (total >= 51) gradeText = "क१";
    else if (total >= 41) gradeText = "क२";
    else if (total >= 31) gradeText = "ड";
    else gradeText = "इ";

    if (gradeCell) gradeCell.textContent = gradeText;
  } else {
    if (grandCell) grandCell.textContent = "";
    if (gradeCell) gradeCell.textContent = "";
  }
}



    // PDF Export (unchanged)
    function downloadPDF() {
  const element = document.getElementById("tablesContainer");
  const opt = {
    margin: [12, 12, 12, 4],                // top/right/bottom/left in mm
    filename: 'Marklist.pdf',
    image: { type: 'jpeg', quality: 1 },
    html2canvas: { scale: 5, useCORS: true, scrollY: 0 }, // <-- scale reduced to 2
    jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' },
    pagebreak: { mode: ['css', 'legacy'] }
  };
  // force shrink before rendering
  element.style.maxWidth = "100%";
  element.style.transform = "scale(0.97)";
  element.style.transformOrigin = "top left";
  html2pdf().from(element).set(opt).save();
  }
// === Enter key moves down in same column ===
  document.addEventListener("keydown", function(e) {
    if (e.key === "Enter") {
      const active = document.activeElement;
      if (active && active.tagName === "INPUT") {
        e.preventDefault();

        // Find current cell
        const td = active.closest("td");
        const tr = active.closest("tr");
        if (!td || !tr) return;

        // Column index of active cell
        const colIndex = Array.from(tr.children).indexOf(td);

        // Next row
        const nextRow = tr.nextElementSibling;
        if (!nextRow) return;

        const nextCell = nextRow.children[colIndex];
        if (!nextCell) return;

        const nextInput = nextCell.querySelector("input");
        if (nextInput) {
          nextInput.focus();
        }
      }
    }
  });
    
  function getStorageKey() {
  const cls = document.getElementById("classSelect").value || "";
  const sec = document.getElementById("sectionSelect").value || "";
  const sessionText = document.getElementById("sessionSelect").value || "";
  const yearText = document.getElementById("yearSelect").value || "";
  const subjectText = document.getElementById("subjectSelect").value || "";
  const teacherText = document.getElementById("teacherSelect").value || "";
  if (!cls || !sec) return null;
  return "marklist_" + encodeURIComponent(`${cls}-${sec}|${sessionText}|${yearText}|${subjectText}|${teacherText}`);
}

function saveData() {
  const storageKey = getStorageKey();
  if (!storageKey) { alert("इयत्ता आणि तुकडी निवडा आणि नंतर Save करा."); return; }

  const data = [];
  document.querySelectorAll("#tablesContainer tbody tr").forEach(row => {
    const rowArr = [];
    row.querySelectorAll("input").forEach(input => rowArr.push(input.value));
    data.push(rowArr);
  });

  localStorage.setItem(storageKey, JSON.stringify(data));
  alert("✅ Data saved successfully!");
}

function loadData() {
  const storageKey = getStorageKey();
  if (!storageKey) return;

  const raw = localStorage.getItem(storageKey);
  if (!raw) return;

  let data;
  try { data = JSON.parse(raw); } catch (err) { return; }

  const rows = document.querySelectorAll("#tablesContainer tbody tr");
  rows.forEach((row, rIndex) => {
    const inputs = Array.from(row.querySelectorAll("input"));
    const savedRow = data[rIndex] || [];
    inputs.forEach((input, cIndex) => {
      input.value = savedRow[cIndex] || "";
      input.dispatchEvent(new Event("input", { bubbles: true })); // recalc totals
    });
  });
}

function clearData() {
  const storageKey = getStorageKey();
  if (!storageKey) { alert("इयत्ता आणि तुकडी निवडा आणि नंतर Clear करा."); return; }
  if (!confirm("Clear all filled marks for this selection?")) return;

  document.querySelectorAll("#tablesContainer tbody tr").forEach(row => {
    row.querySelectorAll("input").forEach(input => {
      input.value = "";
      input.dispatchEvent(new Event("input", { bubbles: true }));
    });
    const a = row.querySelector(".aTotal"); if (a) a.textContent = "";
    const b = row.querySelector(".bTotal"); if (b) b.textContent = "";
    const g = row.querySelector(".grandTotal"); if (g) g.textContent = "";
    const grade = row.querySelector(".grade"); if (grade) grade.textContent = "";
  });

  localStorage.removeItem(storageKey);
  alert("Cleared & removed saved data for this selection.");
}

</script>
</body>
</html>